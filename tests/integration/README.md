# フロントエンドとバックエンドの連携テスト

## 概要

このディレクトリには、フロントエンドとバックエンド間の統合テストが含まれています。これらのテストは、フロントエンドのAPIクライアントとバックエンドのAPIエンドポイントが正しく連携して動作することを検証します。

主な目的:
- フロントエンド/バックエンド間の通信が仕様通りに機能することを確認
- エンドツーエンドのユーザーフローをテスト（商品検索、ユーザー認証、カート操作、注文処理など）
- データの整合性と正しい状態遷移を検証

## テスト構成

- `mocks/` - モックオブジェクト（APIクライアントモックなど）
- `utils/` - テスト用ユーティリティ関数（テストデータ生成、ヘルパー関数など）
- `setup.ts` - テスト環境のセットアップと後処理
- `jest.config.js` - Jest設定ファイル
- `*.test.ts` - 各機能の統合テスト

## 実行方法

### 統合テストの実行

```bash
# すべての統合テストを実行
npm run test:integration

# 特定のテストファイルのみ実行
npm run test:integration -- -t "カート機能"

# 統合テストをウォッチモードで実行（変更があると自動的に再実行）
npm run test:integration:watch

# 統合テストのカバレッジレポートを生成
npm run test:integration:coverage
```

### インメモリデータベース

テストでは、実際のMongoDBデータベースではなく、[mongodb-memory-server](https://github.com/nodkz/mongodb-memory-server)を使用したインメモリデータベースを使用します。これにより、テスト間の完全な独立性が保証され、実際のデータベースに影響を与えることなくテストを実行できます。

## テスト対象の主な機能

1. **商品検索・フィルタリング機能**
   - キーワード検索、カテゴリフィルタ、価格範囲フィルタなど

2. **ユーザー認証と会員機能**
   - 登録、ログイン、プロフィール管理、パスワードリセットなど

3. **カート機能**
   - 商品追加、数量変更、削除、未ログインユーザーのカート管理など

4. **注文処理**
   - 注文作成、支払い、注文履歴、注文詳細など

## テスト手法

- **アプローチ**: APIクライアントを模した統合テスト
- **モック**: 実際のHTTPリクエストではなく、Express.jsアプリケーションに直接リクエストを送信
- **データベース**: mongodb-memory-serverを使用したインメモリデータベース
- **データ分離**: 各テスト間でデータベースをクリーンアップ

## 注意事項

- 統合テストは単体テストよりも実行時間が長くなる場合があります
- すべてのテストがパスするためには、両方のコンポーネント（フロントエンドAPIクライアントとバックエンドAPI）が正しく実装されている必要があります
- 本番環境の接続情報（APIキーなど）は使用せず、テスト用の値またはモックを使用してください 